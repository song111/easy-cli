{"version":3,"sources":["../src/build.js"],"names":["options","api","Api","resolveWebpackConfig","config","fs","remove","output","path","Promise","resolve","reject","err","stats","process","stdout","write","toString","colors","modules","children","chunks","chunkModules","hasErrors","logger","error","Error","hasWarnings","warn","done"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;;2FAEe,iBAAOA,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,YAAAA,GADO,GACD,IAAIC,eAAJ,CAAQ,YAAR,EAAsBF,OAAtB,CADC;AAAA;AAAA,mBAEQC,GAAG,CAACE,oBAAJ,EAFR;;AAAA;AAEPC,YAAAA,MAFO;AAGb,qBAHa,CAIb;;AAJa;AAAA,mBAKPC,aAAGC,MAAH,CAAUF,MAAM,CAACG,MAAP,CAAcC,IAAxB,CALO;;AAAA;AAAA,6CAMN,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,uCAAQP,MAAR,EAAgB,UAACQ,GAAD,EAAMC,KAAN,EAAgB;AAC9B,oBAAID,GAAJ,EAAS,OAAOD,MAAM,CAACC,GAAD,CAAb,CADqB,CAE9B;;AACAE,gBAAAA,OAAO,CAACC,MAAR,CAAeC,KAAf,CACEH,KAAK,CAACI,QAAN,CAAe;AACbC,kBAAAA,MAAM,EAAE,IADK;AAEbC,kBAAAA,OAAO,EAAE,KAFI;AAGbC,kBAAAA,QAAQ,EAAE,KAHG;AAIbC,kBAAAA,MAAM,EAAE,KAJK;AAKbC,kBAAAA,YAAY,EAAE;AALD,iBAAf,IAMK,MAPP;;AASA,oBAAIT,KAAK,CAACU,SAAN,EAAJ,EAAuB;AACrBC,mCAAOC,KAAP,CAAa,MAAb;;AACAd,kBAAAA,MAAM,CAAC,IAAIe,KAAJ,CAAU,sBAAV,CAAD,CAAN;AACD,iBAHD,MAGO,IAAIb,KAAK,CAACc,WAAN,EAAJ,EAAyB;AAC9BH,mCAAOI,IAAP,CAAY,cAAZ;;AACAlB,kBAAAA,OAAO;AACR,iBAHM,MAGA;AACLc,mCAAOK,IAAP,CAAY,MAAZ;;AACAnB,kBAAAA,OAAO;AACR;AACF,eAtBD;AAuBD,aAxBM,CANM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import Api from './api';\nimport webpack from 'webpack';\nimport { fs, logger } from '@chrissong/cli-utils';\n\nexport default async (options) => {\n  const api = new Api('production', options);\n  const config = await api.resolveWebpackConfig();\n  debugger\n  // 清空文件夹\n  await fs.remove(config.output.path)\n  return new Promise((resolve, reject) => {\n    webpack(config, (err, stats) => {\n      if (err) return reject(err)\n      // 打印结果\n      process.stdout.write(\n        stats.toString({\n          colors: true,\n          modules: false,\n          children: false,\n          chunks: false,\n          chunkModules: false\n        }) + '\\n\\n'\n      )\n      if (stats.hasErrors()) {\n        logger.error('打包失败')\n        reject(new Error('Webpack build failed'))\n      } else if (stats.hasWarnings()) {\n        logger.warn('打包成功，但具有警告信息')\n        resolve()\n      } else {\n        logger.done('打包成功')\n        resolve()\n      }\n    })\n  })\n};\n"],"file":"build.js"}