{"version":3,"sources":["../src/webpack.config.js"],"names":["api","chainWebpack","config","env","easyConfig","alias","pages","context","target","output","path","resolve","publicPath","when","Object","keys","forEach","key","set","extensions","merge","end","mainFields","modules","node","setImmediate","process","dgram","fs","net","tls","child_process","optimization","splitChunks","chunks","name","minSize","maxSize","sideEffects","removeEmptyChunks","mergeDuplicateChunks","module","rule","test","exclude","add","use","loader","options","limit"],"mappings":";;;;;;;AAAA;;AAEA;;;;eAKe,kBAACA,GAAD,EAAS;AACtBA,EAAAA,GAAG,CAACC,YAAJ,CAAiB,UAACC,MAAD,EAAY;AAC3B,QAAMC,GAAG,GAAGH,GAAG,CAACG,GAAhB;AAD2B,0BAEGH,GAAG,CAACI,UAFP;AAAA,QAEnBC,KAFmB,mBAEnBA,KAFmB;AAAA,gDAEZC,KAFY;AAAA,QAEZA,KAFY,sCAEJ,EAFI,0BAI3B;;AACAJ,IAAAA,MAAM,CAACK,OAAP,CAAeP,GAAG,CAACO,OAAJ,EAAf,EAA8BC,MAA9B,CAAqC,KAArC,EAL2B,CAO3B;;AACAN,IAAAA,MAAM,CAACO,MAAP,CAAcC,IAAd,CAAmBV,GAAG,CAACW,OAAJ,CAAY,MAAZ,CAAnB,EAAwCC,UAAxC,CAAmD,IAAnD,EAR2B,CAU3B;;AACAV,IAAAA,MAAM,CAACS,OAAP,CACGE,IADH,CACQR,KADR,EACe,UAACH,MAAD,EAAY;AACvBY,MAAAA,MAAM,CAACC,IAAP,CAAYV,KAAZ,EAAmBW,OAAnB,CAA2B,UAACC,GAAD,EAAS;AAClCf,QAAAA,MAAM,CAACG,KAAP,CAAaa,GAAb,CAAiBD,GAAjB,EAAsBjB,GAAG,CAACW,OAAJ,CAAYN,KAAK,CAACY,GAAD,CAAjB,CAAtB;AACD,OAFD;AAGD,KALH,EAMGE,UANH,CAMcC,KANd,CAMoB,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,KAAhC,EAAuC,KAAvC,CANpB,EAOGC,GAPH,GAQGC,UARH,CAQcF,KARd,CAQoB,CAAC,SAAD,EAAY,MAAZ,EAAoB,QAApB,CARpB,EASGC,GATH,GAUGE,OAVH,CAUWH,KAVX,CAUiB,CAAC,cAAD,EAAiBpB,GAAG,CAACW,OAAJ,CAAY,cAAZ,CAAjB,CAVjB;AAYA;;;;AAGAT,IAAAA,MAAM,CAACsB,IAAP,CAAYJ,KAAZ,CAAkB;AAChBK,MAAAA,YAAY,EAAE,KADE;AAEhBC,MAAAA,OAAO,EAAE,MAFO;AAGhBC,MAAAA,KAAK,EAAE,OAHS;AAIhBC,MAAAA,EAAE,EAAE,OAJY;AAKhBC,MAAAA,GAAG,EAAE,OALW;AAMhBC,MAAAA,GAAG,EAAE,OANW;AAOhBC,MAAAA,aAAa,EAAE;AAPC,KAAlB;AAUA;;;;AAGA7B,IAAAA,MAAM,CAAC8B,YAAP,CACGC,WADH,CACe;AACXC,MAAAA,MAAM,EAAE,KADG;AAEXC,MAAAA,IAAI,EAAE,KAFK;AAGXC,MAAAA,OAAO,EAAE,MAAM,IAHJ;AAIXC,MAAAA,OAAO,EAAE,OAAO;AAJL,KADf,EAOGC,WAPH,CAOe,IAPf,EAQGC,iBARH,CAQqB,IARrB,EASGC,oBATH,CASwB,IATxB;AAWA;;;;AAGAtC,IAAAA,MAAM,CAACuC,MAAP,CACGC,IADH,CACQ,OADR,EAEGC,IAFH,CAEQ,SAFR,EAGGC,OAHH,CAGWC,GAHX,CAGe7C,GAAG,CAACW,OAAJ,CAAY,cAAZ,CAHf,EAIGU,GAJH,GAKGyB,GALH,CAKO,cALP,EAMGC,MANH,CAMU,cANV;AAQA;;;;AAGA7C,IAAAA,MAAM,CAACuC,MAAP,CACGC,IADH,CACQ,QADR,EAEGC,IAFH,CAEQ,gCAFR,EAGGG,GAHH,CAGO,YAHP,EAIGC,MAJH,CAIU,YAJV,EAKGC,OALH,CAKW;AACPC,MAAAA,KAAK,EAAE,IADA;AAEPd,MAAAA,IAAI,EAAE;AAFC,KALX;AASD,GAzED;AA0ED,C","sourcesContent":["import {} from 'webpack';\n\n/**\n * webpack通用配置\n * @param{Object} api api实例\n */\n\nexport default (api) => {\n  api.chainWebpack((config) => {\n    const env = api.env;\n    const { alias, pages = {} } = api.easyConfig;\n\n    // 设置context\n    config.context(api.context()).target('web');\n\n    // output配置\n    config.output.path(api.resolve('dist')).publicPath('./');\n\n    // resolve 配置\n    config.resolve\n      .when(alias, (config) => {\n        Object.keys(alias).forEach((key) => {\n          config.alias.set(key, api.resolve(alias[key]));\n        });\n      })\n      .extensions.merge(['.js', '.jsx', '.json', '.ts', 'tsx', 'css'])\n      .end()\n      .mainFields.merge(['browser', 'main', 'module'])\n      .end()\n      .modules.merge(['node_modules', api.resolve('node_modules')]);\n\n    /**\n     * 设置node变量\n     */\n    config.node.merge({\n      setImmediate: false,\n      process: 'mock',\n      dgram: 'empty',\n      fs: 'empty',\n      net: 'empty',\n      tls: 'empty',\n      child_process: 'empty'\n    });\n\n    /**\n     * 代码切割与打包优化\n     */\n    config.optimization\n      .splitChunks({\n        chunks: 'all',\n        name: false,\n        minSize: 600 * 1024,\n        maxSize: 1000 * 1024\n      })\n      .sideEffects(true)\n      .removeEmptyChunks(true)\n      .mergeDuplicateChunks(true);\n\n    /**\n     * babel配置\n     */\n    config.module\n      .rule('babel')\n      .test(/\\.jsx?$/)\n      .exclude.add(api.resolve('node_modules'))\n      .end()\n      .use('babel-loader')\n      .loader('babel-loader');\n\n    /**\n     * 图片文件loader\n     */\n    config.module\n      .rule('images')\n      .test(/\\.(png|jpe?g|gif|webp)(\\?.*)?$/)\n      .use('url-loader')\n      .loader('url-loader')\n      .options({\n        limit: 8192,\n        name: 'static/images/[name].[hash:7].[ext]'\n      });\n  });\n};\n"],"file":"webpack.config.js"}