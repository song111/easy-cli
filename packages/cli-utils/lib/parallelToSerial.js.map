{"version":3,"sources":["../src/parallelToSerial.js"],"names":["items","length","Promise","resolve","reject","res","next","i","slice","all","map","item","then","value","push","err"],"mappings":";;;;;;;;;;;AAAA;;;;;;;eAOe,kBAACA,KAAD,EAAuB;AAAA,MAAfC,MAAe,uEAAN,CAAM;AACpC,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAMC,GAAG,GAAG,EAAZ;;AACA,aAASC,IAAT,CAAeC,CAAf,EAAkB;AAChB,UAAMC,KAAK,GAAGR,KAAK,CAACQ,KAAN,CAAYD,CAAZ,EAAeA,CAAC,GAAGN,MAAnB,CAAd;AACAM,MAAAA,CAAC,IAAIN,MAAL,CAFgB,CAGhB;;AACA,UAAIO,KAAK,CAACP,MAAV,EAAkB;AAChB;AACAC,QAAAA,OAAO,CAACO,GAAR,CAAYD,KAAK,CAACE,GAAN,CAAU,UAACC,IAAD;AAAA,iBAAUA,IAAI,EAAd;AAAA,SAAV,CAAZ,EACGC,IADH,CACQ,UAACC,KAAD,EAAW;AACfR,UAAAA,GAAG,CAACS,IAAJ,OAAAT,GAAG,sCAASQ,KAAT,EAAH;AACAP,UAAAA,IAAI,CAACC,CAAD,CAAJ;AACD,SAJH,WAKS,UAACQ,GAAD;AAAA,iBAASX,MAAM,CAACW,GAAD,CAAf;AAAA,SALT;AAMD,OARD,MAQO;AACLZ,QAAAA,OAAO,CAACE,GAAD,CAAP;AACD;AACF;;AACDC,IAAAA,IAAI,CAAC,CAAD,CAAJ;AACD,GAnBM,CAAP;AAoBD,C","sourcesContent":["/**\r\n * 把任务集合转换为串行任务\r\n * 串行执行时可指定每次同时(并发)可执行任务的条数\r\n * @param {Array} items 任务列表\r\n * @param {Number} length 每次并发任务的条数\r\n * @return {Promise<Array>} Promise对象按切片执行结果\r\n */\r\nexport default (items, length = 1) => {\r\n  return new Promise((resolve, reject) => {\r\n    const res = [];\r\n    function next (i) {\r\n      const slice = items.slice(i, i + length);\r\n      i += length;\r\n      // 如果数据执行完之后就直接返回\r\n      if (slice.length) {\r\n        // 执行处理逻辑\r\n        Promise.all(slice.map((item) => item()))\r\n          .then((value) => {\r\n            res.push(...value);\r\n            next(i);\r\n          })\r\n          .catch((err) => reject(err));\r\n      } else {\r\n        resolve(res);\r\n      }\r\n    }\r\n    next(0);\r\n  });\r\n};\r\n"],"file":"parallelToSerial.js"}