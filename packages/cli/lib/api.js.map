{"version":3,"sources":["../src/api.js"],"names":["cli","cwd","pkg","env","argv","root","version","register","cmd","desc","name","split","test","Error","chalk","redBright","commands","args"],"mappings":";;;;;;;eAAe,kBAACA,GAAD,EAAS;AACtB,SAAO;AACL;;;AAGAC,IAAAA,GAJK,iBAIC;AACJ,aAAOD,GAAG,CAACC,GAAX;AACD,KANI;;AAQL;;;AAGAC,IAAAA,GAXK,iBAWC;AACJ,aAAOF,GAAG,CAACE,GAAX;AACD,KAbI;;AAeL;;;AAGAC,IAAAA,GAlBK,iBAkBC;AACJ,aAAOH,GAAG,CAACG,GAAX;AACD,KApBI;;AAsBL;;;AAGAC,IAAAA,IAzBK,kBAyBE;AACL,aAAOJ,GAAG,CAACI,IAAX;AACD,KA3BI;;AA6BL;;;AAGAC,IAAAA,IAhCK,kBAgCE;AACL,aAAOL,GAAG,CAACK,IAAX;AACD,KAlCI;;AAoCL;;;AAGAC,IAAAA,OAvCK,qBAuCK;AACR,aAAON,GAAG,CAACM,OAAX;AACD,KAzCI;;AA2CL;;;;;;;AAOAC,IAAAA,QAlDK,oBAkDIC,GAlDJ,EAkDSC,IAlDT,EAkDwB;AAC3B,UAAMC,IAAI,GAAGF,GAAG,CAACG,KAAJ,CAAU,KAAV,EAAiB,CAAjB,CAAb,CAD2B,CAE3B;;AACA,UAAI,CAAC,WAAWC,IAAX,CAAgBF,IAAhB,CAAL,EACE,MAAM,IAAIG,KAAJ,oCAAkBC,KAAK,CAACC,SAAN,CAAgBL,IAAhB,CAAlB,yHAAN;AACF,UAAI,CAACD,IAAL,EAAW,MAAM,IAAII,KAAJ,CAAU,eAAV,CAAN;AACX,UAAIb,GAAG,CAACgB,QAAJ,CAAaN,IAAb,CAAJ,EAAwB,MAAM,IAAIG,KAAJ,wBAAgBC,KAAK,CAACC,SAAN,CAAgBL,IAAhB,CAAhB,qCAAN;;AANG,wCAANO,IAAM;AAANA,QAAAA,IAAM;AAAA;;AAO3BjB,MAAAA,GAAG,CAACO,QAAJ,OAAAP,GAAG,GAAUU,IAAV,EAAgBF,GAAhB,EAAqBC,IAArB,SAA8BQ,IAA9B,EAAH;AACD;AA1DI,GAAP;AA4DD,C","sourcesContent":["export default (cli) => {\r\n  return {\r\n    /**\r\n     * 获取命令执行路径\r\n     */\r\n    cwd() {\r\n      return cli.cwd;\r\n    },\r\n\r\n    /**\r\n     * 获取package.json的内容\r\n     */\r\n    pkg() {\r\n      return cli.pkg;\r\n    },\r\n\r\n    /**\r\n     * 获取当前环境的所有环境变量\r\n     */\r\n    env() {\r\n      return cli.env;\r\n    },\r\n\r\n    /**\r\n     * 获取process.argv.slice(2)\r\n     */\r\n    argv() {\r\n      return cli.argv;\r\n    },\r\n\r\n    /**\r\n     * 获取项目根目录\r\n     */\r\n    root() {\r\n      return cli.root;\r\n    },\r\n\r\n    /**\r\n     * 获取cli版本\r\n     */\r\n    version() {\r\n      return cli.version;\r\n    },\r\n\r\n    /**\r\n     * 注册命令\r\n     * api内容可参考yargs\r\n     * @param {String} cmd\r\n     * @param {String} desc\r\n     * @param  {...any} args\r\n     */\r\n    register(cmd, desc, ...args) {\r\n      const name = cmd.split(/\\s+/)[0];\r\n      // 只能有数字、字母、下划线、冒号组成\r\n      if (!/^[\\w:]+$/.test(name))\r\n        throw new Error(`命令名称 ${chalk.redBright(name)} 不合法，只能是字母、数字、下划线、冒号`);\r\n      if (!desc) throw new Error('命令描述 desc 不存在');\r\n      if (cli.commands[name]) throw new Error(`命令 ${chalk.redBright(name)} 已经被占用`);\r\n      cli.register(name, cmd, desc, ...args);\r\n    }\r\n  };\r\n};\r\n"],"file":"api.js"}